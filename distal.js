function distal(e,f){var j=new Function;j.prototype=f;var f=new j,j=distal.resolve,b=e,t=e.ownerDocument,n=!!e.querySelectorAll,u="innerText"in e?"innerText":"textContent",B={className:1,"class":1,innerHTML:1,style:1,src:1,href:1,id:1,value:1,checked:1,selected:1,label:1,htmlFor:1,text:1,title:1,disabled:1},i=distal,v=i.beforeAttr,w=i.beforeText,x=i.qif||"data-qif",s=i.qrepeat||"data-qrepeat",y=i.qattr||"data-qattr",z=i.qtext||"data-qtext",q=i.qdup||"data-qdup",A=i.format,i=i.qdef||"data-qdef",r="*["+[i,x,s,y,z].join("],*[")+"]",c,C=function(a){return this[a]},d=e.parentNode;for(;(b=e.nextSibling)&&(b.qdup||1==b.nodeType&&b.getAttribute(q));)d.removeChild(b);var o,p=[0],m,l=0,a,g;if(n){for(m=e.querySelectorAll("*["+q+"]");b=m[l++];)b.parentNode.removeChild(b);l=0}o=[n?e.querySelectorAll(r):e.getElementsByTagName("*")];for(m=[e];;){for(b=m[l++];!b&&(m=o.pop());)l=p.pop(),b=m[l++];if(!b)break;if(a=b.getAttribute(i))a=a.split(" "),f[a[0]]=j(f,a[1]);if(a=b.getAttribute(x)){a=a.split(" ");0==a[0].indexOf("not:")&&(a=[a[0].substr(4),"not",0]);if((c=j(f,a[0]))&&c.join&&-1<c.length)c=c.length;if(2<a.length)switch(a[3]&&(a[2]=a.slice(2).join(" ")),"number"==typeof c&&(a[2]*=1),a[1]){case"not":a=!c;break;case"eq":a=c==a[2];break;case"ne":a=c!=a[2];break;case"gt":a=c>a[2];break;case"lt":a=c<a[2];break;case"cn":a=c&&0<=c.indexOf(a[2]);break;case"nc":a=c&&0>c.indexOf(a[2]);break;default:throw b;}else a=c;if(a)b.style.display="";else{b.style.display="none";l=n?l+b.querySelectorAll(r).length:l+b.getElementsByTagName("*").length;continue}}if(a=b.getAttribute(s)){g=a.split(" ");if(!n)for(c=b.parentNode;(d=b.nextSibling)&&(d.qdup||1==d.nodeType&&d.getAttribute(q));)c.removeChild(d);if(!g[1])throw g;if((c=j(f,g[1]))&&c.length)b.style.display="",f[g[0]]=c[0];else{b.style.display="none";l=n?l+b.querySelectorAll(r).length:l+b.getElementsByTagName("*").length;continue}if(1<c.length){c=Array(c.length-1);for(var k=d=c.length;0<k;k--)c[d-k]=k;d=b.cloneNode(!0);"form"in d&&(d.checked=!1);d.setAttribute(i,a);d.removeAttribute(s);d.setAttribute(q,"1");var d=d.outerHTML||t.createElement("div").appendChild(d).parentNode.innerHTML,h=d.indexOf(" "+i+'="'+a+'"');-1==h&&(h=d.indexOf(" "+i+"='"+a+"'"));h=h+i.length+3+a.length;c=d.substr(0,h)+"."+c.join(d.substr(h)+d.substr(0,h)+".")+d.substr(h);d=t.createElement("div");"cells"in b?(d.innerHTML="<table>"+c+"</table>",d=d.firstChild.tBodies[0].childNodes):"cellIndex"in b?(d.innerHTML="<table><tr>"+c+"</tr></table>",d=d.firstChild.tBodies[0].firstChild.childNodes):"selected"in b&&"text"in b?(d.innerHTML="<select>"+c+"</select>",d=d.firstChild.childNodes):(d.innerHTML=c,d=d.childNodes);h=b.parentNode;g=b.nextSibling;if(n||b==e){o.push(m);p.push(l);m={getAttribute:C};m[i]=a+".0";o.push([m]);p.push(0);m=[];for(k=d.length-1;0<=k;k--)c=d[k],o.push(n?c.querySelectorAll(r):c.getElementsByTagName("*")),p.push(0),o.push([c]),p.push(0),c.qdup=1,h.insertBefore(c,g)}else for(k=d.length-1;0<=k;k--)c=d[k],c.qdup=1,h.insertBefore(c,g);h.selectedIndex=-1}}if(a=b.getAttribute(y)){c=a.split("; ");for(k=c.length-1;0<=k;k--){a=c[k].split(" ");g=a[0];if(!a[1])throw a;h=j(f,a[1])||"";v&&v(b,g,h);if(a=a[2]&&A[a[2]])h=a(h);if(B[g])switch(g){case"innerHTML":throw b;case"disabled":case"checked":case"selected":b[g]=!!h;break;case"style":b.style.cssText=h;break;case"text":b[n?g:u]=h;break;case"class":g="className";default:b[g]=h}else b.setAttribute(g,h)}}if(a=b.getAttribute(z)){a=a.split(" ");c="html"==a[0];g=j(f,a[c?1:0])||"";w&&w(b,g);if((a=a[c?2:1])&&(a=A[a]))g=a(g);c?b.innerHTML=g:b["form"in b?"value":u]=g}}}distal.resolve=function(e,f,j,b){if(j=e[f])return"function"==typeof j?j.call(e,f):j;f=f.split(".");for(j=0;f[j]&&(b=e)&&(e=e[f[j++]]););return"function"==typeof e?e.call(b,f.join(".")):e};distal.format={",.":function(e,f){f=1*e;return isNaN(f)?e:(f%1?f.toFixed(2):parseInt(f,10)+"").replace(/(^\d{1,3}|\d{3})(?=(?:\d{3})+(?:$|\.))/g,"$1,")}};"function"==typeof define&&define.amd&&define("distal",function(){return distal});